Assigned device: cuda
Number of processes (GPUs) used by Accelerator: 1
/home/onebom/anaconda3/envs/vp2/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
using ddim samping with 50 steps
***** Running training *****
  Num examples = 20825
  Num Epochs = 1000
  Instantaneous batch size per device = 2
  Total train batch size (w. parallel, distributed & accumulation) = 8
  Gradient Accumulation steps = 4
  Total optimization steps = 2604000
epoch 0, lr= 0.0000000
Steps:   0%|                                                                                                                                                                                                                                                          | 0/2604000 [00:00<?, ?it/s]/home/onebom/anaconda3/envs/vp2/lib/python3.9/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608883701/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Steps:   0%|                                                                                                                                                                       | 424/2604000 [09:05<919:49:27,  1.27s/it, total_loss=0.922, diffusion_loss=0.922, template_loss=0, lr=8.48e-7]Traceback (most recent call last):
  File "/data/onebom/project/point_based_vp/ongoing/wo_cond_original_vp/train_direct.py", line 274, in <module>
    main(cfg)
  File "/data/onebom/project/point_based_vp/ongoing/wo_cond_original_vp/train_direct.py", line 263, in main
    train(cfg)
  File "/data/onebom/project/point_based_vp/ongoing/wo_cond_original_vp/train_direct.py", line 141, in train
    losses.synchronize_and_update(accelerator, total_loss, global_step)
  File "/data/onebom/project/point_based_vp/ongoing/wo_cond_original_vp/utils/meter.py", line 59, in synchronize_and_update
    val = val.item()
KeyboardInterrupt
